import{J as j,av as A,aw as H,r as T,c as J,ax as q,ay as G,az as K,w as O,aA as P,aB as U,a0 as L,aC as Q,a4 as k,b as c,aD as W,a3 as i,a7 as o,aE as b,aF as X,aG as Z,Y as ee,a2 as r,e as g,v as y,a6 as d,a1 as v,V as h,R as w,aH as V,m as te,aI as ae,aJ as z,aK as se}from"./index-BwhUO2KD.js";import{T as x}from"./index-DqM4W03L.js";import"./VTooltip-NmZeG8rA.js";import"./VOverlay-dLpR-l5e.js";import"./forwardRefs-Bg-aax2e.js";import"./transition-BNTZnmXC.js";const oe={ref:"rootRef",class:"datePicker"},ne={class:"d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},re={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},le=["value"],ie={class:"d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},de={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},ue=["value"],ve={__name:"EodashDatePicker",props:{hintText:{type:String,default:null},hideArrows:{type:Boolean,default:!1},hideInputField:{type:Boolean,default:!1},toggleCalendar:{type:Boolean,default:!1}},setup(n){ee(t=>({"254ea936":C.value}));const{lgAndDown:f}=j(),B=A("rootRef"),M=A("datePicker"),u=H((t,e)=>({get(){return t(),new Date(b.value).getTime()},set(a){e(),P.debug("Datepicker setting currentDate",b.value);const s=new Date(a);b.value=s.toISOString(),M.value?.move({month:s.getMonth()+1,year:s.getFullYear()})}})),E=T({input:"YYYY-MM-DD"}),F=t=>{const e=t.getFullYear(),a=t.getMonth()+1,s=t.getDate();return`${e}-${a<10?"0"+a:a}-${s<10?"0"+s:s}`},R=t=>{u.value=new Date(t.target?.value).getTime()},$=J(()=>F(new Date(u.value))),l=q([]),{selectedCompareStac:Y,selectedStac:_}=G(K());O([_,Y],async([t,e])=>{if(l.splice(0,l.length),!t&&!e){P.debug("No STAC selected, clearing datepicker attributes");return}const a=[...await D(X),...await D(Z)];l.push(...a)},{immediate:!0});async function D(t){return!t||!t.length?[]:await Promise.all(t.map((e,a)=>e.fetchCollection().then(()=>{const s=U(e.getItems());if(!s)return[];const p=[...new Set(e.getItems()?.reduce((S,N)=>{const I=Date.parse(N[s]);return I&&S.push(new Date(I)),S},[]))];return{key:"id-"+a.toString()+Math.random().toString(16).slice(2),dot:{style:{backgroundColor:e.color}},dates:p,content:{style:{color:"#000000","font-weight":"bold"}}}})))}function m(t){if(l.length){let e=t?1/0:-1/0;l.forEach(a=>{a?.dates&&a.dates.forEach(s=>{s instanceof Date&&(e=Math[t?"min":"max"](e,s.getTime()))})}),u.value=e===-1/0?Date.now():e===1/0?0:e}}const C=T("");return L(()=>{C.value=document.querySelector("eo-dash")?"translate3d(50px,-80px,0)":"translate3d(0px,-80px,0)"}),Q(B),(t,e)=>(r(),k("div",oe,[c(o(se),{ref:"datePicker",modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=a=>u.value=a),modelModifiers:{number:!0},attributes:l,masks:E.value,expanded:"",class:"overflow-auto",style:{"background-color":"transparent","max-width":"100%"}},W({_:2},[n.toggleCalendar?{name:"default",fn:i(({inputValue:a,inputEvents:s})=>[g("div",ne,[n.hideArrows?d("v-if",!0):y((r(),v(h,{key:0,density:"compact",size:o(f)?"x-small":"large",variant:"text",onClick:e[0]||(e[0]=p=>m(!0)),class:"py-2",style:{"flex-shrink":"1",padding:"0"}},{default:i(()=>[c(w,{icon:[o(V)]},null,8,["icon"])]),_:1},8,["size"])),[[x,"Set date to oldest available dataset","bottom"]]),g("div",re,[n.hideInputField?d("v-if",!0):(r(),k("input",te({key:0,value:a},ae(s,!0),{class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}}),null,16,le))]),n.hideArrows?d("v-if",!0):y((r(),v(h,{key:1,density:"compact",size:o(f)?"x-small":"large",variant:"text",onClick:e[1]||(e[1]=p=>m(!1)),class:"py-2",style:{"flex-shrink":"1",padding:"0"}},{default:i(()=>[c(w,{icon:[o(z)]},null,8,["icon"])]),_:1},8,["size"])),[[x,"Set date to latest available dataset","bottom"]])])]),key:"0"}:{name:"footer",fn:i(()=>[g("div",ie,[n.hideArrows?d("v-if",!0):y((r(),v(h,{key:0,density:"compact",size:o(f)?"x-small":"large",variant:"text",onClick:e[2]||(e[2]=a=>m(!0)),class:"py-2",style:{"flex-shrink":"1"}},{default:i(()=>[c(w,{icon:[o(V)]},null,8,["icon"])]),_:1},8,["size"])),[[x,"Set date to oldest available dataset","bottom"]]),g("div",de,[n.hideInputField?d("v-if",!0):(r(),k("input",{key:0,value:$.value,onChange:R,class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},null,40,ue))]),n.hideArrows?d("v-if",!0):y((r(),v(h,{key:1,density:"compact",size:o(f)?"x-small":"large",variant:"text",onClick:e[3]||(e[3]=a=>m(!1)),class:"py-2",style:{"flex-shrink":"1"}},{default:i(()=>[c(w,{icon:[o(z)]},null,8,["icon"])]),_:1},8,["size"])),[[x,"Set date to latest available dataset","bottom"]])])]),key:"1"}]),1032,["modelValue","attributes","masks"])],512))}};export{ve as default};
