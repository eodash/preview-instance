import{G as N,au as P,av as G,r as T,c as H,aw as O,t as U,ax as q,w as Z,ay as b,az as u,aA as J,aB as V,Y as K,aC as L,a1 as D,b as f,aD as Q,a0 as i,a4 as o,aE as S,U as W,$ as l,a7 as p,j as h,a3 as d,Z as v,V as w,O as x,aF as z,m as X,aG as ee,aH as B,aI as te}from"./index-ofgZE0U6.js";import{T as k}from"./index-CzvEtOHt.js";import"./VTooltip-W1p5sVkZ.js";import"./VOverlay-_oHpcUU2.js";import"./forwardRefs-B0nDwVPk.js";import"./transition-29wJ9Bhq.js";const ae={ref:"rootRef",class:"datePicker"},se={class:"bg-surface d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},oe={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},ne=["value"],le={class:"d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},re={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},ie=["value"],ye={__name:"EodashDatePicker",props:{hintText:{type:String,default:null},hideArrows:{type:Boolean,default:!1},hideInputField:{type:Boolean,default:!1},toggleCalendar:{type:Boolean,default:!1}},setup(n){W(a=>({"4a7baeca":C.value}));const{lgAndDown:m}=N(),M=P("rootRef"),$=P("datePicker"),c=G((a,t)=>({get(){return a(),new Date(S.value).getTime()},set(e){t(),b.debug("Datepicker setting currentDate",S.value);const s=new Date(e);S.value=s.toISOString(),$.value?.move({month:s.getMonth()+1,year:s.getFullYear()})}})),E=T({input:"YYYY-MM-DD"}),F=a=>{const t=a.getFullYear(),e=a.getMonth()+1,s=a.getDate();return`${t}-${e<10?"0"+e:e}-${s<10?"0"+s:s}`},R=a=>{c.value=new Date(a.target?.value).getTime()},Y=H(()=>F(new Date(c.value))),r=O([]),_=U(q(),"selectedStac");Z(_,async(a,t)=>{if(a&&t?.id!==a.id){b.debug("Datepicker selected STAC change triggered"),r.splice(0,r.length);for(let e=0;e<u.length;e++){b.debug("Retrieving dates",u[e]),await u[e].fetchCollection();const s=J(u[e].getItems());if(!s)continue;const y=[...new Set(u[e].getItems()?.reduce((I,j)=>{const A=Date.parse(j[s]);return A&&I.push(new Date(A)),I},[]))];r.push({key:"id-"+e.toString()+Math.random().toString(16).slice(2),dot:{style:{backgroundColor:V[e%V.length]}},dates:y,content:{style:{color:"#000000","font-weight":"bold"}}})}}},{immediate:!0});function g(a){if(r.length){let t=a?1/0:-1/0;r.forEach(e=>{e?.dates&&e.dates.forEach(s=>{s instanceof Date&&(t=Math[a?"min":"max"](t,s.getTime()))})}),c.value=t===-1/0?Date.now():t===1/0?0:t}}const C=T("");return K(()=>{C.value=document.querySelector("eo-dash")?"translate3d(50px,-80px,0)":"translate3d(0px,-80px,0)"}),L(M),(a,t)=>(l(),D("div",ae,[f(o(te),{ref:"datePicker",modelValue:c.value,"onUpdate:modelValue":t[4]||(t[4]=e=>c.value=e),modelModifiers:{number:!0},attributes:r,masks:E.value,expanded:"",class:"bg-surface overflow-auto",style:{"background-color":"transparent","max-width":"100%"}},Q({_:2},[n.toggleCalendar?{name:"default",fn:i(({inputValue:e,inputEvents:s})=>[p("div",se,[n.hideArrows?d("v-if",!0):h((l(),v(w,{key:0,density:"compact",size:o(m)?"x-small":"large",variant:"text",onClick:t[0]||(t[0]=y=>g(!0)),class:"py-2",style:{"flex-shrink":"1"}},{default:i(()=>[f(x,{icon:[o(z)]},null,8,["icon"])]),_:1},8,["size"])),[[k,"Set date to oldest available dataset","bottom"]]),p("div",oe,[n.hideInputField?d("v-if",!0):(l(),D("input",X({key:0,value:e},ee(s,!0),{class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}}),null,16,ne))]),n.hideArrows?d("v-if",!0):h((l(),v(w,{key:1,density:"compact",size:o(m)?"x-small":"large",variant:"text",onClick:t[1]||(t[1]=y=>g(!1)),class:"py-2",style:{"flex-shrink":"1"}},{default:i(()=>[f(x,{icon:[o(B)]},null,8,["icon"])]),_:1},8,["size"])),[[k,"Set date to latest available dataset","bottom"]])])]),key:"0"}:{name:"footer",fn:i(()=>[p("div",le,[n.hideArrows?d("v-if",!0):h((l(),v(w,{key:0,density:"compact",size:o(m)?"x-small":"large",variant:"text",onClick:t[2]||(t[2]=e=>g(!0)),class:"py-2",style:{"flex-shrink":"1"}},{default:i(()=>[f(x,{icon:[o(z)]},null,8,["icon"])]),_:1},8,["size"])),[[k,"Set date to oldest available dataset","bottom"]]),p("div",re,[n.hideInputField?d("v-if",!0):(l(),D("input",{key:0,value:Y.value,onChange:R,class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},null,40,ie))]),n.hideArrows?d("v-if",!0):h((l(),v(w,{key:1,density:"compact",size:o(m)?"x-small":"large",variant:"text",onClick:t[3]||(t[3]=e=>g(!1)),class:"py-2",style:{"flex-shrink":"1"}},{default:i(()=>[f(x,{icon:[o(B)]},null,8,["icon"])]),_:1},8,["size"])),[[k,"Set date to latest available dataset","bottom"]])])]),key:"1"}]),1032,["modelValue","attributes","masks"])],512))}};export{ye as default};
