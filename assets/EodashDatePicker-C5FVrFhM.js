import{u as N,a4 as A,U as Y,a5 as _,n as j,a6 as U,o as q,a as H,b as x,f as c,a7 as O,w as i,a8 as W,a9 as G,s as J,e as l,x as g,A as p,y as d,d as y,W as v,V as h,aa as T,g as K,ab as L,ac as I,ad as Q}from"./main-QnrEKAFF.js";import{k as X,a as V,m as Z,l as w,u as o,o as b}from"./templates-CeJFuBW4.js";import{T as k}from"./index-CwFarWFF.js";import"./VTooltip-D0t2G5QS.js";import"./forwardRefs-CDAZIxda.js";import"./transition-CXooAU6F.js";const ee={ref:"rootRef",class:"datePicker"},te={class:"d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},ae={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},se=["value"],oe={class:"d-flex flex-row align-center justify-center pb-1",style:{overflow:"hidden",width:"100%"}},ne={class:"flex rounded-lg border border-gray-300 dark:border-gray-600",style:{margin:"2px","min-width":"0"}},le=["value"],me={__name:"EodashDatePicker",props:{hintText:{type:String,default:null},hideArrows:{type:Boolean,default:!1},hideInputField:{type:Boolean,default:!1},toggleCalendar:{type:Boolean,default:!1}},setup(n){J(a=>({"5270a4d4":C.value}));const{lgAndDown:f}=N(),M=A("rootRef"),$=A("datePicker"),u=X((a,e)=>({get(){return a(),new Date(b.value).getTime()},set(t){e(),w.debug("Datepicker setting currentDate",b.value);const s=new Date(t);if(isNaN(s.getTime())){w.warn("Invalid date value provided to datepicker:",t);return}b.value=s.toISOString(),$.value?.move({month:s.getMonth()+1,year:s.getFullYear()})}})),z=V({input:"YYYY-MM-DD"}),B=a=>{const e=a.getFullYear(),t=a.getMonth()+1,s=a.getDate();return`${e}-${t<10?"0"+t:t}-${s<10?"0"+s:s}`},P=a=>{u.value=new Date(a.target?.value).getTime()},E=Y(()=>B(new Date(u.value))),r=Z([]),{selectedCompareStac:F,selectedStac:R}=_(j());U([R,F],async([a,e])=>{if(r.splice(0,r.length),!a&&!e){w.debug("No STAC selected, clearing datepicker attributes");return}const t=[...await D(W),...await D(G)];r.push(...t)},{immediate:!0});async function D(a){return!a||!a.length?[]:await Promise.all(a.map((e,t)=>e.fetchCollection().then(async()=>{const s=await e.getDates();if(!s||!s.length){w.debug(`Collection ${e.collectionStac?.id} has no dates, skipping datepicker attribute`);return}return{key:"id-"+t.toString()+Math.random().toString(16).slice(2),dot:{style:{backgroundColor:e.color}},dates:s,content:{style:{color:"#000000","font-weight":"bold"}}}})))}function m(a){if(r.length){let e=a?1/0:-1/0;r.forEach(t=>{t?.dates&&t.dates.forEach(s=>{s instanceof Date&&(e=Math[a?"min":"max"](e,s.getTime()))})}),u.value=e===-1/0?Date.now():e===1/0?0:e}}const C=V("");return q(()=>{C.value=document.querySelector("eo-dash")?"translate3d(50px,-80px,0)":"translate3d(0px,-80px,0)"}),H(M),(a,e)=>(l(),x("div",ee,[c(o(Q),{ref:"datePicker",modelValue:u.value,"onUpdate:modelValue":e[4]||(e[4]=t=>u.value=t),modelModifiers:{number:!0},attributes:r,masks:z.value,expanded:"",class:"overflow-auto",style:{"background-color":"transparent","max-width":"100%"}},O({_:2},[n.toggleCalendar?{name:"default",fn:i(({inputValue:t,inputEvents:s})=>[g("div",te,[n.hideArrows?d("v-if",!0):p((l(),y(v,{key:0,density:"compact",size:o(f)?"x-small":"large",variant:"text",onClick:e[0]||(e[0]=S=>m(!0)),class:"py-2",style:{"flex-shrink":"1",padding:"0"}},{default:i(()=>[c(h,{icon:[o(T)]},null,8,["icon"])]),_:1},8,["size"])),[[k,"Set date to oldest available dataset","bottom"]]),g("div",ae,[n.hideInputField?d("v-if",!0):(l(),x("input",K({key:0,value:t},L(s,!0),{class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}}),null,16,se))]),n.hideArrows?d("v-if",!0):p((l(),y(v,{key:1,density:"compact",size:o(f)?"x-small":"large",variant:"text",onClick:e[1]||(e[1]=S=>m(!1)),class:"py-2",style:{"flex-shrink":"1",padding:"0"}},{default:i(()=>[c(h,{icon:[o(I)]},null,8,["icon"])]),_:1},8,["size"])),[[k,"Set date to latest available dataset","bottom"]])])]),key:"0"}:{name:"footer",fn:i(()=>[g("div",oe,[n.hideArrows?d("v-if",!0):p((l(),y(v,{key:0,density:"compact",size:o(f)?"x-small":"large",variant:"text",onClick:e[2]||(e[2]=t=>m(!0)),class:"py-2",style:{"flex-shrink":"1"}},{default:i(()=>[c(h,{icon:[o(T)]},null,8,["icon"])]),_:1},8,["size"])),[[k,"Set date to oldest available dataset","bottom"]]),g("div",ne,[n.hideInputField?d("v-if",!0):(l(),x("input",{key:0,value:E.value,onChange:P,class:"flex-grow px-1 py-1 dark:bg-gray-700",style:{margin:"1px",width:"100%","white-space":"nowrap",overflow:"hidden","text-overflow":"ellipsis"}},null,40,le))]),n.hideArrows?d("v-if",!0):p((l(),y(v,{key:1,density:"compact",size:o(f)?"x-small":"large",variant:"text",onClick:e[3]||(e[3]=t=>m(!1)),class:"py-2",style:{"flex-shrink":"1"}},{default:i(()=>[c(h,{icon:[o(I)]},null,8,["icon"])]),_:1},8,["size"])),[[k,"Set date to latest available dataset","bottom"]])])]),key:"1"}]),1032,["modelValue","attributes","masks"])],512))}};export{me as default};
